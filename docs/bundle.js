!function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(i,a,function(t){return e[t]}.bind(null,a));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=13)}({0:function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},13:function(e,t,n){"use strict";n.r(t);var i=n(2),a=n.n(i),r={android:function(){return navigator.userAgent.match(/Android/i)},blackberry:function(){return navigator.userAgent.match(/BlackBerry/i)},ios:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},opera:function(){return navigator.userAgent.match(/Opera Mini/i)},windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return r.android()||r.blackberry()||r.ios()||r.opera()||r.windows()}},o=r;function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={init:function(){var e="pk.eyJ1IjoiZG9jazQyNDIiLCJhIjoiY2pjazE5eTM2NDl2aDJ3cDUyeDlsb292NiJ9.Jr__XbmAolbLyzPDj7-8kQ",t=!0,n=7,i=d3.select("#content").node().getBoundingClientRect().width;d3.select("#content").node().getBoundingClientRect().height,function(){var e=d3.select(".legend");e.append("p").attr("class","legend-title").text("Population / 1,000 sq. meters");var t=d3.format(","),n=e.selectAll("div").data([[1,"#fbeee0"],[250,"#f3ba7c"],[1500,"#f32020"],[5e3,"#830707"],[1e4,"#4b0707"]]).enter().append("div").attr("class","legend-box");n.append("div").attr("class","legend-color").style("background-color",function(e){return e[1]}),n.append("p").attr("class","legend-name").text(function(e){return t(4*e[0])})}();var a=2;.9*i<1300&&(a=2);var r=Math.min(Math.floor(.9*i/a),450),o=r,c=d3.select(".single-year-wrapper").selectAll("div").data([{city_name:"New York City",city_id:"new_york_city",population:"18.8M People",city_text:"",location:{center:[-73.98,40.76],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:-33.19,pitch:60}},{city_name:"London",city_id:"london",population:"9M People",city_text:"",location:{center:[-.23,51.43],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:-19.59,pitch:60}},{city_name:"Singapore",city_id:"singapore",population:"5.7M People",city_text:'Among these few cities, Singapore is among the most “planned,” and it isn’t expected to eclipse 10M people at its growth rate. In its background is Kuala Lumpur, a city that’s 2M people larger than Singapore but <a href="https://www.freemalaysiatoday.com/category/nation/2017/08/10/kl-risks-becoming-worlds-most-unplanned-city-says-mp/">far less planned</a>—note the lower density but larger footprint.<br><br>Let’s now tour 13 newer megacities and the “form” of their present-day populations.',location:{center:[103.838,1.411],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:8.63,bearing:-38.48,pitch:60}},{city_name:"Kinshasa",city_id:"kinshasa",city_text:'<span>KINSHASA (13.1M people)&mdash;</span> Since 2001, Kinshasa has grown from the 38th to 23rd largest city in the world. One of the biggest challenges facing this city is transportation: <a href="https://capx.co/africa-is-urbanising-without-globalising/">getting to Kinshasa is difficult</a>, and you can see this in the population data. Kinshasa is a mountain surrounded by few settlements (compare this to a similar city, such as Paris, where the surrounding city is heavily suburbanized).',location:{center:[15.31,-4.36],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:0,pitch:60}},{city_name:"Pearl River Delta",city_id:"hong_kong",city_text:"<span>PEARL RIVER DELTA (50M - 100M people)&mdash;</span> This is actually three cities: Hong Kong (7.4M people), Shenzhen (11.9M), Guangzhou (12.6M). For all intents and purposes, they are close enough in proximity to form the largest urban agglomerations on earth, approaching 50 million people with non-stop urban density. This map would have looked much differently 30 years ago, when Shenzhen was was under 1M people and Guangzhou was 3.2M.",location:{center:[113.570587,22.78],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:0,pitch:60}},{city_name:"Bangalore",city_id:"bangalore",city_text:"<span>BANGALORE (11.4M people)&mdash;</span> It reached megacity status in the 2010s (over 10M people), led by its burgeoning tech sector (aka the “Silicon Valley of India”). The population density of India is obvious is the above images, with Bangalore surrounded by incredibly dense urban settlements. The mostly unplanned growth has come at a cost, as covered by The Guardian, “The situation is very worrying. People are moving out. Illnesses are increasing. At this rate every house will need a dialysis machine...Bangalore cannot continue like this. It is becoming an unliveable city. This is the worst city in the world for unchecked urbanisation.”",location:{center:[77.511,13.109],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:-23.18,pitch:60}},{city_name:"Luanda",city_id:"luanda",city_text:"TBD",location:{center:[13.36,-8.705],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:-21.6,pitch:60}},{city_name:"Dar es Salaam",city_id:"dar_es_salaam",city_text:"TBD",location:{center:[39.14,-6.845],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:-21.6,pitch:60}},{city_name:"Kuala Lumpur",city_id:"kuala_lumpur",city_text:"TBD",location:{center:[-84.386,33.754],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:-16.8,pitch:60}}]).enter().append("div").attr("class","img-wrapper"),l=c.append("div").attr("class",function(e){return"swiper-container "+e.city_id});function p(i,a,s){console.log(s);var c=i.location,l=c.bearing,p=c.pitch,d=c.center[1],u=c.center[0],f=c.zoom;c.pathString,t&&(f=n);var h="cjo5jr9510nfb2sp0ixdls6fw";return"3D"!=s&&(p=0),"medium"==a&&(f=6,h="cjoojxw063ksk2spglbhik1g8"),"medium-two"==a&&(f=5.1,h="cjoojxw063ksk2spglbhik1g8"),"medium-far"==a&&(f=4.2,h="cjo5tayip0w952rpski8ml7w0"),"super-far"==a&&(f=3,h="cjo5tayip0w952rpski8ml7w0"),"3D"!=s&&"close"!=a&&(p=0,h="cjo7b0rly2am02sqoz0b4zs0y"),"3D"!=s&&"close"==a&&(h="cjo7bhuwn056i2srxhhqjer8v"),"https://api.mapbox.com/styles/v1/dock4242/"+h+"/static/"+u+","+d+","+f+","+l+","+p+"/"+r+"x"+o+"@2x?access_token="+e}c.append("div").attr("class","text-column").append("p").attr("class","city-desc").html(function(e){return e.city_text});var d=l.append("div").attr("class","swiper-wrapper"),u=(l.append("div").attr("class","swiper-pagination"),["close","medium","medium-two","medium-far","super-far"]),f=d.selectAll("div").data(u).enter().append("div").attr("class","swiper-slide").style("width",r+"px").style("height",o+"px"),h=(f.filter(function(e,t){return console.log(t),0==t}).append("p").attr("class","city-title").html(function(e,t){var n=d3.select(this.parentNode.parentNode).datum().city_id;return["london","new_york_city","singapore"].indexOf(n)>-1?d3.select(this.parentNode.parentNode).datum().city_name+"<span>"+d3.select(this.parentNode.parentNode).datum().population+"</span>":d3.select(this.parentNode.parentNode).datum().city_name}),f.filter(function(e,t){return"hong_kong"==d3.select(this.parentNode.parentNode).datum().city_id&&0==t}).append("div").attr("class","overlay-div").html('<svg viewBox="0 0 450 450" fill="none" xmlns="http://www.w3.org/2000/svg"> <text fill="black" xml:space="preserve" style="white-space: pre" font-family="Atlas Grotesk" font-size="16" font-weight="bold" letter-spacing="0em"><tspan x="315.281" y="318.992">Hong Kong</tspan></text> <text fill="black" xml:space="preserve" style="white-space: pre" font-family="Atlas Grotesk" font-size="16" font-weight="bold" letter-spacing="0em"><tspan x="176.023" y="342.992">Shenzhen</tspan></text> <text fill="black" xml:space="preserve" style="white-space: pre" font-family="Atlas Grotesk" font-size="16" font-weight="bold" letter-spacing="0em"><tspan x="35.0156" y="367.992">Guangzhou</tspan></text> <path d="M298.5 251.5C234 232 230.5 262.5 216 319" stroke="black" stroke-width="3"/> <path d="M168 162C94 199 58.9999 260 79.0002 348" stroke="black" stroke-width="3"/> </svg>'),f.append("div").attr("class","border-div"));f.append("div").attr("class","mask-div"),h.style("width",function(e,t){return 0==t?r+"px":1==t?"100px":2==t?"50px":3==t?"30px":"20px"}).style("height",function(e,t){return 0==t?o-40+"px":1==t?"100px":2==t?"50px":3==t?"30px":"20px"}),f.append("img").style("width",r+"px").style("height",o+"px").attr("src",function(e){return p(d3.select(this.parentNode.parentNode).datum(),e,"3D")}),l.append("p").attr("class","fraction").text("1/"+Math.ceil(u.length-1)),l.append("div").attr("class","city-toggles").selectAll("div").data(["3D","overhead"]).enter().append("div").attr("class","city-toggle").classed("city-toggle-active",function(e,t){return console.log(t),0==t}).on("click",function(e){!function(e,t){var n=t.city_id;l.filter(function(e,t){return e.city_id==n}).selectAll(".swiper-slide").select("img").attr("src",function(e){return""}),l.filter(function(e,t){return e.city_id==n}).selectAll(".swiper-slide").select("img").attr("src",function(t){return p(d3.select(this.parentNode.parentNode).datum(),t,e)})}(e,d3.select(this.parentNode).datum()),d3.select(this.parentNode).selectAll(".city-toggle").classed("city-toggle-active",!1),d3.select(this).classed("city-toggle-active",!0)}).append("p").attr("class","city-toggle-text").html(function(e){return e}),l.each(function(e,t,n){var i,r=d3.select(this);e.swiper=new Swiper("."+e.city_id,(s(i={spaceBetween:22,slidesPerView:a,grabCursor:!0,freeMode:!0,mousewheel:{invert:!0,forceToAxis:!0}},"slidesPerView","auto"),s(i,"slideToClickedSlide",!0),s(i,"pagination",{el:d3.select("."+e.city_id).select(".swiper-pagination").node(),clickable:!0}),i)),e.swiper.on("slideChange",function(){r.select(".fraction").text(e.swiper.activeIndex+1+"/"+Math.ceil(u.length-1))})}),d3.json("assets/data/world.json",function(e){var t=f.filter(function(e,t){return console.log(t),0==t}).append("div").attr("width","70px").attr("height","70px").attr("class","globe-wrapper");t.append("div").attr("class","globe-wrapper-svg-container").html('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" viewBox="0 -256 1792 1792" id="svg3025" version="1.1" inkscape:version="0.48.3.1 r9886" width="100%" height="100%"> <g transform="matrix(1,0,0,-1,364.47458,1270.2373)"> <path d="m 768,896 q 0,106 -75,181 -75,75 -181,75 -106,0 -181,-75 -75,-75 -75,-181 0,-106 75,-181 75,-75 181,-75 106,0 181,75 75,75 75,181 z m 256,0 q 0,-109 -33,-179 L 627,-57 q -16,-33 -47.5,-52 -31.5,-19 -67.5,-19 -36,0 -67.5,19 Q 413,-90 398,-57 L 33,717 Q 0,787 0,896 q 0,212 150,362 150,150 362,150 212,0 362,-150 150,-150 150,-362 z" id="path3029" inkscape:connector-curvature="0" /> </g> </svg>'),t.append("canvas").attr("width",70).attr("height",70).each(function(t){t=d3.select(this.parentNode.parentNode.parentNode).datum();var n=d3.geoOrthographic().translate([35,35]).scale(30).rotate([-t.location.center[0],-t.location.center[1]]).clipAngle(90),i=n([t.location.center[0],t.location.center[1]]);d3.select(this.parentNode).select(".globe-wrapper-svg-container").style("transform","translate("+i[0]+"px,"+i[1]+"px)");var a=d3.select(this).node().getContext("2d"),r=d3.geoPath().projection(n).context(a),o=topojson.feature(e,e.objects.land);a.clearRect(0,0,70,70),a.beginPath(),a.arc(35,35,28,0,2*Math.PI,!0),a.fillStyle="#263138",a.fill(),a.beginPath(),r(o),a.fillStyle="#fff",a.fill()})})},resize:function(){}},l=d3.select("body"),p=0;function d(){var e=l.node().offsetWidth;p!==e&&(p=e,c.resize())}l.classed("is-mobile",o.any()),window.addEventListener("resize",a()(d,150)),function(){if(l.select("header").classed("is-sticky")){var e=l.select(".header__menu"),t=l.select(".header__toggle");t.on("click",function(){var n=e.classed("is-visible");e.classed("is-visible",!n),t.classed("is-visible",!n)})}}(),c.init()},2:function(e,t,n){(function(t){var n="Expected a function",i=NaN,a="[object Symbol]",r=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt,p="object"==typeof t&&t&&t.Object===Object&&t,d="object"==typeof self&&self&&self.Object===Object&&self,u=p||d||Function("return this")(),f=Object.prototype.toString,h=Math.max,g=Math.min,y=function(){return u.Date.now()};function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function v(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&f.call(e)==a}(e))return i;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var n=s.test(e);return n||c.test(e)?l(e.slice(2),n?2:8):o.test(e)?i:+e}e.exports=function(e,t,i){var a,r,o,s,c,l,p=0,d=!1,u=!1,f=!0;if("function"!=typeof e)throw new TypeError(n);function w(t){var n=a,i=r;return a=r=void 0,p=t,s=e.apply(i,n)}function b(e){var n=e-l;return void 0===l||n>=t||n<0||u&&e-p>=o}function x(){var e=y();if(b(e))return k(e);c=setTimeout(x,function(e){var n=t-(e-l);return u?g(n,o-(e-p)):n}(e))}function k(e){return c=void 0,f&&a?w(e):(a=r=void 0,s)}function _(){var e=y(),n=b(e);if(a=arguments,r=this,l=e,n){if(void 0===c)return function(e){return p=e,c=setTimeout(x,t),d?w(e):s}(l);if(u)return c=setTimeout(x,t),w(l)}return void 0===c&&(c=setTimeout(x,t)),s}return t=v(t)||0,m(i)&&(d=!!i.leading,o=(u="maxWait"in i)?h(v(i.maxWait)||0,t):o,f="trailing"in i?!!i.trailing:f),_.cancel=function(){void 0!==c&&clearTimeout(c),p=0,a=l=r=c=void 0},_.flush=function(){return void 0===c?s:k(y())},_}}).call(this,n(0))}});