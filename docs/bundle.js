!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=13)}({0:function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},13:function(t,e,n){"use strict";n.r(e);var i=n(2),r=n.n(i),o={android:function(){return navigator.userAgent.match(/Android/i)},blackberry:function(){return navigator.userAgent.match(/BlackBerry/i)},ios:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},opera:function(){return navigator.userAgent.match(/Opera Mini/i)},windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return o.android()||o.blackberry()||o.ios()||o.opera()||o.windows()}},a=o;var c={init:function(){!function(){var t=[-74.331,41.261];mapboxgl.accessToken="pk.eyJ1IjoiZG9jazQyNDIiLCJhIjoiY2pjazE5eTM2NDl2aDJ3cDUyeDlsb292NiJ9.Jr__XbmAolbLyzPDj7-8kQ";var e=new mapboxgl.Map({container:"map",style:"mapbox://styles/dock4242/cjnugndzr4rkn2spbxk0cnps5?optimize=true",center:[t[0],t[1]],zoom:6,pitch:0,bearing:0,interactive:!1});e.scrollZoom.disable(),e.on("load",function(t){e.setLayoutProperty("place-city-large","visibility","visible")});var n=new ScrollMagic.Controller,i=0,r=0;new ScrollMagic.Scene({triggerElement:"#fixed-map",duration:d3.select(".scroll__text").node().getBoundingClientRect().height-Math.max(document.documentElement.clientHeight,window.innerHeight||0)/2,offset:0,triggerHook:0}).setPin("#fixed-map",{pushfollowers:!1}).addTo(n),new ScrollMagic.Scene({triggerElement:"#tilt-shift-step",duration:d3.select("#tilt-shift-step").node().getBoundingClientRect().height,offset:0,triggerHook:.5}).on("progress",function(t){var n=t.progress;(n=Math.round(50*n)/50)!=i&&(i=n,e.jumpTo({pitch:60*i,bearing:0}))}).addTo(n),new ScrollMagic.Scene({triggerElement:"#rotate-step",duration:d3.select("#rotate-step").node().getBoundingClientRect().height,offset:0,triggerHook:.5}).on("progress",function(t){var n=t.progress;(n=Math.round(50*n)/50)!=r&&(r=n,e.jumpTo({bearing:-65.6*r,pitch:60}))}).addTo(n)}();var t="pk.eyJ1IjoiZG9jazQyNDIiLCJhIjoiY2pjazE5eTM2NDl2aDJ3cDUyeDlsb292NiJ9.Jr__XbmAolbLyzPDj7-8kQ",e=!0,n=7,i=d3.select("#content").node().getBoundingClientRect().width,r=d3.select("#content").node().getBoundingClientRect().height;d3.select(".intro-image").append("img").attr("src",function(){return"https://api.mapbox.com/styles/v1/dock4242/cjo5tayip0w952rpski8ml7w0/static/71.02,-1.29,2.64,0,60/"+i+"x"+Math.min(.5*r,500)+"@2x?access_token=pk.eyJ1IjoiZG9jazQyNDIiLCJhIjoiY2pjazE5eTM2NDl2aDJ3cDUyeDlsb292NiJ9.Jr__XbmAolbLyzPDj7-8kQ"});var o=2;.9*i<1300&&(o=2);var a=Math.min(Math.floor(.9*i/o),450),c=a,s=d3.select(".single-year-wrapper").selectAll("div").data([{city_name:"Hong Kong",city_id:"hong_kong",city_text:"The world’s population centers are a lot different than 25 years ago. In 1993, there were 14 cities over 10 million people. Today, there are 34, with many of these new “megacities” sprouting from farmland in our lifetimes.",location:{center:[113.570587,22.78],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:0,pitch:60}}]).enter().append("div").attr("class","img-wrapper"),l=s.append("div").attr("class","swiper-container"),p=s.append("div").attr("class","text-column");function d(i,r,o){console.log(o);var s=i.location,l=s.bearing,p=s.pitch,d=s.center[1],u=s.center[0],f=s.zoom,g=s.pathString,h="";e&&(f=n);var m="cjnugndzr4rkn2spbxk0cnps5";return"3D"!=o&&(p=0),"medium"==r&&(f=4.6,m="cjo5tayip0w952rpski8ml7w0"),"3D"!=o&&"medium"!=r&&"close"!=r&&(h="path-2+444-0.8+f44-0("+g+")/"),"far"==r&&(f=3.6,m="cjo5tayip0w952rpski8ml7w0"),"super-far"==r&&(f=2.6,m="cjo5tayip0w952rpski8ml7w0",h="path-2+444-0.8+f44-0("+g+")/"),"3D"!=o&&"close"!=r&&(p=0,m="cjo7b0rly2am02sqoz0b4zs0y",h="path-2+444-0.8+f44-0("+g+")/"),"3D"!=o&&"close"==r&&(m="cjo7bhuwn056i2srxhhqjer8v"),"https://api.mapbox.com/styles/v1/dock4242/"+m+"/static/"+h+u+","+d+","+f+","+l+","+p+"/"+a+"x"+c+"@2x?access_token="+t}p.append("p").attr("class","city-name").html(function(t){return t.city_name}),p.append("p").attr("class","city-desc").html(function(t){return t.city_text});var u=l.append("div").attr("class","swiper-wrapper"),f=(l.append("div").attr("class","swiper-pagination"),["close","medium","far","super-far"]),g=u.selectAll("div").data(f).enter().append("div").attr("class","swiper-slide").style("width",a+"px").style("height",c+"px");g.append("div").attr("class","border-div").style("width",function(t,e){return 0==e?a+"px":1==e?"85px":"40px"}).style("height",function(t,e){return 0==e?c-40+"px":1==e?"85px":"40px"}),g.append("img").style("width",a+"px").style("height",c+"px").attr("src",function(t){return d(d3.select(this.parentNode.parentNode).datum(),t,"3D")}),l.append("p").attr("class","fraction").text("1/"+Math.ceil(f.length-1)),l.append("div").attr("class","city-toggles").selectAll("div").data(["3D","overhead"]).enter().append("div").attr("class","city-toggle").classed("city-toggle-active",function(t,e){return console.log(e),0==e}).on("click",function(t){!function(t,e){var n=e.city_id;l.filter(function(t,e){return t.city_id==n}).selectAll(".swiper-slide").select("img").attr("src",function(e){return d(d3.select(this.parentNode.parentNode).datum(),e,t)})}(t,d3.select(this.parentNode).datum()),d3.select(this.parentNode).selectAll(".city-toggle").classed("city-toggle-active",!1),d3.select(this).classed("city-toggle-active",!0)}).append("p").attr("class","city-toggle-text").html(function(t){return t}),l.each(function(t,e,n){var i=d3.select(this),r=new Swiper(n,{spaceBetween:22,slidesPerView:o,grabCursor:!0,pagination:{el:".swiper-pagination",clickable:!0}});r.on("slideChange",function(t){i.select(".fraction").text(r.activeIndex+1+"/"+Math.ceil(f.length-1))})}),d3.json("assets/data/world.json",function(t){var e=g.filter(function(t,e){return 0==e}).append("div").attr("width","70px").attr("height","70px").attr("class","globe-wrapper");e.append("div").attr("class","globe-wrapper-svg-container").html('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" viewBox="0 -256 1792 1792" id="svg3025" version="1.1" inkscape:version="0.48.3.1 r9886" width="100%" height="100%"> <g transform="matrix(1,0,0,-1,364.47458,1270.2373)"> <path d="m 768,896 q 0,106 -75,181 -75,75 -181,75 -106,0 -181,-75 -75,-75 -75,-181 0,-106 75,-181 75,-75 181,-75 106,0 181,75 75,75 75,181 z m 256,0 q 0,-109 -33,-179 L 627,-57 q -16,-33 -47.5,-52 -31.5,-19 -67.5,-19 -36,0 -67.5,19 Q 413,-90 398,-57 L 33,717 Q 0,787 0,896 q 0,212 150,362 150,150 362,150 212,0 362,-150 150,-150 150,-362 z" id="path3029" inkscape:connector-curvature="0" /> </g> </svg>'),e.append("canvas").attr("width",70).attr("height",70).each(function(e){e=d3.select(this.parentNode.parentNode.parentNode).datum();var n=d3.geoOrthographic().translate([35,35]).scale(30).rotate([-e.location.center[0],-e.location.center[1]]).clipAngle(90),i=n([e.location.center[0],e.location.center[1]]);d3.select(this.parentNode).select(".globe-wrapper-svg-container").style("transform","translate("+i[0]+"px,"+i[1]+"px)");var r=d3.select(this).node().getContext("2d"),o=d3.geoPath().projection(n).context(r),a=topojson.feature(t,t.objects.land);r.clearRect(0,0,70,70),r.beginPath(),r.arc(35,35,28,0,2*Math.PI,!0),r.fillStyle="#263138",r.fill(),r.beginPath(),o(a),r.fillStyle="#fff",r.fill()})})},resize:function(){}},s=d3.select("body"),l=0;function p(){var t=s.node().offsetWidth;l!==t&&(l=t,c.resize())}s.classed("is-mobile",a.any()),window.addEventListener("resize",r()(p,150)),function(){if(s.select("header").classed("is-sticky")){var t=s.select(".header__menu"),e=s.select(".header__toggle");e.on("click",function(){var n=t.classed("is-visible");t.classed("is-visible",!n),e.classed("is-visible",!n)})}}(),c.init()},2:function(t,e,n){(function(e){var n="Expected a function",i=NaN,r="[object Symbol]",o=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,s=/^0o[0-7]+$/i,l=parseInt,p="object"==typeof e&&e&&e.Object===Object&&e,d="object"==typeof self&&self&&self.Object===Object&&self,u=p||d||Function("return this")(),f=Object.prototype.toString,g=Math.max,h=Math.min,m=function(){return u.Date.now()};function v(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function y(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&f.call(t)==r}(t))return i;if(v(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=v(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var n=c.test(t);return n||s.test(t)?l(t.slice(2),n?2:8):a.test(t)?i:+t}t.exports=function(t,e,i){var r,o,a,c,s,l,p=0,d=!1,u=!1,f=!0;if("function"!=typeof t)throw new TypeError(n);function w(e){var n=r,i=o;return r=o=void 0,p=e,c=t.apply(i,n)}function b(t){var n=t-l;return void 0===l||n>=e||n<0||u&&t-p>=a}function x(){var t=m();if(b(t))return j(t);s=setTimeout(x,function(t){var n=e-(t-l);return u?h(n,a-(t-p)):n}(t))}function j(t){return s=void 0,f&&r?w(t):(r=o=void 0,c)}function k(){var t=m(),n=b(t);if(r=arguments,o=this,l=t,n){if(void 0===s)return function(t){return p=t,s=setTimeout(x,e),d?w(t):c}(l);if(u)return s=setTimeout(x,e),w(l)}return void 0===s&&(s=setTimeout(x,e)),c}return e=y(e)||0,v(i)&&(d=!!i.leading,a=(u="maxWait"in i)?g(y(i.maxWait)||0,e):a,f="trailing"in i?!!i.trailing:f),k.cancel=function(){void 0!==s&&clearTimeout(s),p=0,r=l=o=s=void 0},k.flush=function(){return void 0===s?c:j(m())},k}}).call(this,n(0))}});