!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=13)}({0:function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},13:function(e,t,n){"use strict";n.r(t);var i=n(2),r=n.n(i),o={android:function(){return navigator.userAgent.match(/Android/i)},blackberry:function(){return navigator.userAgent.match(/BlackBerry/i)},ios:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},opera:function(){return navigator.userAgent.match(/Opera Mini/i)},windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return o.android()||o.blackberry()||o.ios()||o.opera()||o.windows()}},a=o;function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={init:function(){!function(){var e=[-74.331,41.261];mapboxgl.accessToken="pk.eyJ1IjoiZG9jazQyNDIiLCJhIjoiY2pjazE5eTM2NDl2aDJ3cDUyeDlsb292NiJ9.Jr__XbmAolbLyzPDj7-8kQ";var t=new mapboxgl.Map({container:"map",style:"mapbox://styles/dock4242/cjnugndzr4rkn2spbxk0cnps5?optimize=true",center:[e[0],e[1]],zoom:6,pitch:0,bearing:0,interactive:!1});t.scrollZoom.disable(),t.on("load",function(e){t.setLayoutProperty("place-city-large","visibility","visible")});var n=new ScrollMagic.Controller,i=0,r=0;new ScrollMagic.Scene({triggerElement:"#fixed-map",duration:d3.select(".scroll__text").node().getBoundingClientRect().height-Math.max(document.documentElement.clientHeight,window.innerHeight||0)/2,offset:0,triggerHook:0}).setPin("#fixed-map",{pushfollowers:!1}).addTo(n),new ScrollMagic.Scene({triggerElement:"#tilt-shift-step",duration:d3.select("#tilt-shift-step").node().getBoundingClientRect().height,offset:0,triggerHook:.5}).on("progress",function(e){var n=e.progress;(n=Math.round(50*n)/50)!=i&&(i=n,t.jumpTo({pitch:60*i,bearing:0}))}).addTo(n),new ScrollMagic.Scene({triggerElement:"#rotate-step",duration:d3.select("#rotate-step").node().getBoundingClientRect().height,offset:0,triggerHook:.5}).on("progress",function(e){var n=e.progress;(n=Math.round(50*n)/50)!=r&&(r=n,t.jumpTo({bearing:-65.6*r,pitch:60}))}).addTo(n)}();var e="pk.eyJ1IjoiZG9jazQyNDIiLCJhIjoiY2pjazE5eTM2NDl2aDJ3cDUyeDlsb292NiJ9.Jr__XbmAolbLyzPDj7-8kQ",t=!0,n=7,i=d3.select("#content").node().getBoundingClientRect().width,r=d3.select("#content").node().getBoundingClientRect().height;!function(){var e=d3.select(".legend");e.append("p").attr("class","legend-title").text("Population / 1,000 sq. meters");var t=d3.format(","),n=e.selectAll("div").data([[1,"#fbeee0"],[250,"#f3ba7c"],[1500,"#f32020"],[5e3,"#830707"],[1e4,"#4b0707"]]).enter().append("div").attr("class","legend-box");n.append("div").attr("class","legend-color").style("background-color",function(e){return e[1]}),n.append("p").attr("class","legend-name").text(function(e){return t(4*e[0])})}(),d3.select(".intro-image").append("img").attr("src",function(){return"https://api.mapbox.com/styles/v1/dock4242/cjo5tayip0w952rpski8ml7w0/static/71.02,-1.29,2.64,0,60/"+Math.min(1280,i)+"x"+Math.min(.5*r,500)+"@2x?access_token=pk.eyJ1IjoiZG9jazQyNDIiLCJhIjoiY2pjazE5eTM2NDl2aDJ3cDUyeDlsb292NiJ9.Jr__XbmAolbLyzPDj7-8kQ"});var o=2;.9*i<1300&&(o=2);var a=Math.min(Math.floor(.9*i/o),450),c=a,l=d3.select(".single-year-wrapper").selectAll("div").data([{city_name:"Kinshasa",city_id:"kinshasa",city_text:"<span>KINSHASA (13.1M people)&mdash;</span> The world’s population centers are a lot different than 25 years ago. In 1993, there were 14 cities over 10 million people. Today, there are 34, with many of these new “megacities” sprouting from farmland in our lifetimes.",location:{center:[15.31,-4.36],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:0,pitch:60}},{city_name:"Hong Kong",city_id:"hong_kong",city_text:"The world’s population centers are a lot different than 25 years ago. In 1993, there were 14 cities over 10 million people. Today, there are 34, with many of these new “megacities” sprouting from farmland in our lifetimes.",location:{center:[113.570587,22.78],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:0,pitch:60}},{city_name:"Bangalore",city_id:"bangalore",city_text:"The world’s population centers are a lot different than 25 years ago. In 1993, there were 14 cities over 10 million people. Today, there are 34, with many of these new “megacities” sprouting from farmland in our lifetimes.",location:{center:[77.511,13.109],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:-23.18,pitch:60}},{city_name:"Luanda",city_id:"luanda",city_text:"The world’s population centers are a lot different than 25 years ago. In 1993, there were 14 cities over 10 million people. Today, there are 34, with many of these new “megacities” sprouting from farmland in our lifetimes.",location:{center:[13.36,-8.705],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:-21.6,pitch:60}},{city_name:"Dar es Salaam",city_id:"dar_es_salaam",city_text:"The world’s population centers are a lot different than 25 years ago. In 1993, there were 14 cities over 10 million people. Today, there are 34, with many of these new “megacities” sprouting from farmland in our lifetimes.",location:{center:[39.14,-6.845],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:-21.6,pitch:60}},{city_name:"Kuala Lumpur",city_id:"kuala_lumpur",city_text:"The world’s population centers are a lot different than 25 years ago. In 1993, there were 14 cities over 10 million people. Today, there are 34, with many of these new “megacities” sprouting from farmland in our lifetimes.",location:{center:[-84.386,33.754],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:-16.8,pitch:60}},{city_name:"London",city_id:"london",city_text:"The world’s population centers are a lot different than 25 years ago. In 1993, there were 14 cities over 10 million people. Today, there are 34, with many of these new “megacities” sprouting from farmland in our lifetimes.",location:{center:[-.23,51.43],pathString:"knxnCswrnT}qVaj~FveoI{fsDpvfAjuoH",zoom:7.13,bearing:-19.59,pitch:60}}]).enter().append("div").attr("class","img-wrapper"),p=l.append("div").attr("class",function(e){return"swiper-container "+e.city_id});function d(i,r,o){console.log(o);var s=i.location,l=s.bearing,p=s.pitch,d=s.center[1],u=s.center[0],f=s.zoom;s.pathString,t&&(f=n);var g="cjo5jr9510nfb2sp0ixdls6fw";return"3D"!=o&&(p=0),"medium"==r&&(f=6,g="cjoojxw063ksk2spglbhik1g8"),"medium-two"==r&&(f=5.1,g="cjoojxw063ksk2spglbhik1g8"),"medium-far"==r&&(f=4.2,g="cjo5tayip0w952rpski8ml7w0"),"super-far"==r&&(f=3,g="cjo5tayip0w952rpski8ml7w0"),"3D"!=o&&"close"!=r&&(p=0,g="cjo7b0rly2am02sqoz0b4zs0y"),"3D"!=o&&"close"==r&&(g="cjo7bhuwn056i2srxhhqjer8v"),"https://api.mapbox.com/styles/v1/dock4242/"+g+"/static/"+u+","+d+","+f+","+l+","+p+"/"+a+"x"+c+"@2x?access_token="+e}l.append("div").attr("class","text-column").append("p").attr("class","city-desc").html(function(e){return e.city_text});var u=p.append("div").attr("class","swiper-wrapper"),f=(p.append("div").attr("class","swiper-pagination"),["close","medium","medium-two","medium-far","super-far"]),g=u.selectAll("div").data(f).enter().append("div").attr("class","swiper-slide").style("width",a+"px").style("height",c+"px"),h=(g.filter(function(e,t){return console.log(t),0==t}).append("p").attr("class","city-title").text(function(e,t){return d3.select(this.parentNode.parentNode).datum().city_name}),g.filter(function(e,t){return"hong_kong"==d3.select(this.parentNode.parentNode).datum().city_id&&0==t}).append("div").attr("class","overlay-div").html('<svg viewBox="0 0 450 450" fill="none" xmlns="http://www.w3.org/2000/svg"> <text fill="black" xml:space="preserve" style="white-space: pre" font-family="Atlas Grotesk" font-size="16" font-weight="bold" letter-spacing="0em"><tspan x="315.281" y="318.992">Hong Kong</tspan></text> <text fill="black" xml:space="preserve" style="white-space: pre" font-family="Atlas Grotesk" font-size="16" font-weight="bold" letter-spacing="0em"><tspan x="176.023" y="342.992">Shenzhen</tspan></text> <text fill="black" xml:space="preserve" style="white-space: pre" font-family="Atlas Grotesk" font-size="16" font-weight="bold" letter-spacing="0em"><tspan x="35.0156" y="367.992">Guangzhou</tspan></text> <path d="M298.5 251.5C234 232 230.5 262.5 216 319" stroke="black" stroke-width="3"/> <path d="M168 162C94 199 58.9999 260 79.0002 348" stroke="black" stroke-width="3"/> </svg>'),g.append("div").attr("class","border-div"));g.append("div").attr("class","mask-div"),h.style("width",function(e,t){return 0==t?a+"px":1==t?"100px":2==t?"50px":3==t?"30px":"20px"}).style("height",function(e,t){return 0==t?c-40+"px":1==t?"100px":2==t?"50px":3==t?"30px":"20px"}),g.append("img").style("width",a+"px").style("height",c+"px").attr("src",function(e){return d(d3.select(this.parentNode.parentNode).datum(),e,"3D")}),p.append("p").attr("class","fraction").text("1/"+Math.ceil(f.length-1)),p.append("div").attr("class","city-toggles").selectAll("div").data(["3D","overhead"]).enter().append("div").attr("class","city-toggle").classed("city-toggle-active",function(e,t){return console.log(t),0==t}).on("click",function(e){!function(e,t){var n=t.city_id;p.filter(function(e,t){return e.city_id==n}).selectAll(".swiper-slide").select("img").attr("src",function(e){return""}),p.filter(function(e,t){return e.city_id==n}).selectAll(".swiper-slide").select("img").attr("src",function(t){return d(d3.select(this.parentNode.parentNode).datum(),t,e)})}(e,d3.select(this.parentNode).datum()),d3.select(this.parentNode).selectAll(".city-toggle").classed("city-toggle-active",!1),d3.select(this).classed("city-toggle-active",!0)}).append("p").attr("class","city-toggle-text").html(function(e){return e}),p.each(function(e,t,n){var i,r=d3.select(this);e.swiper=new Swiper("."+e.city_id,(s(i={spaceBetween:22,slidesPerView:o,grabCursor:!0,freeMode:!0,mousewheel:{invert:!0,forceToAxis:!0}},"slidesPerView","auto"),s(i,"slideToClickedSlide",!0),s(i,"pagination",{el:d3.select("."+e.city_id).select(".swiper-pagination").node(),clickable:!0}),i)),e.swiper.on("slideChange",function(){r.select(".fraction").text(e.swiper.activeIndex+1+"/"+Math.ceil(f.length-1))})}),d3.json("assets/data/world.json",function(e){var t=g.filter(function(e,t){return console.log(t),0==t}).append("div").attr("width","70px").attr("height","70px").attr("class","globe-wrapper");t.append("div").attr("class","globe-wrapper-svg-container").html('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" viewBox="0 -256 1792 1792" id="svg3025" version="1.1" inkscape:version="0.48.3.1 r9886" width="100%" height="100%"> <g transform="matrix(1,0,0,-1,364.47458,1270.2373)"> <path d="m 768,896 q 0,106 -75,181 -75,75 -181,75 -106,0 -181,-75 -75,-75 -75,-181 0,-106 75,-181 75,-75 181,-75 106,0 181,75 75,75 75,181 z m 256,0 q 0,-109 -33,-179 L 627,-57 q -16,-33 -47.5,-52 -31.5,-19 -67.5,-19 -36,0 -67.5,19 Q 413,-90 398,-57 L 33,717 Q 0,787 0,896 q 0,212 150,362 150,150 362,150 212,0 362,-150 150,-150 150,-362 z" id="path3029" inkscape:connector-curvature="0" /> </g> </svg>'),t.append("canvas").attr("width",70).attr("height",70).each(function(t){t=d3.select(this.parentNode.parentNode.parentNode).datum();var n=d3.geoOrthographic().translate([35,35]).scale(30).rotate([-t.location.center[0],-t.location.center[1]]).clipAngle(90),i=n([t.location.center[0],t.location.center[1]]);d3.select(this.parentNode).select(".globe-wrapper-svg-container").style("transform","translate("+i[0]+"px,"+i[1]+"px)");var r=d3.select(this).node().getContext("2d"),o=d3.geoPath().projection(n).context(r),a=topojson.feature(e,e.objects.land);r.clearRect(0,0,70,70),r.beginPath(),r.arc(35,35,28,0,2*Math.PI,!0),r.fillStyle="#263138",r.fill(),r.beginPath(),o(a),r.fillStyle="#fff",r.fill()})})},resize:function(){}},l=d3.select("body"),p=0;function d(){var e=l.node().offsetWidth;p!==e&&(p=e,c.resize())}l.classed("is-mobile",a.any()),window.addEventListener("resize",r()(d,150)),function(){if(l.select("header").classed("is-sticky")){var e=l.select(".header__menu"),t=l.select(".header__toggle");t.on("click",function(){var n=e.classed("is-visible");e.classed("is-visible",!n),t.classed("is-visible",!n)})}}(),c.init()},2:function(e,t,n){(function(t){var n="Expected a function",i=NaN,r="[object Symbol]",o=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt,p="object"==typeof t&&t&&t.Object===Object&&t,d="object"==typeof self&&self&&self.Object===Object&&self,u=p||d||Function("return this")(),f=Object.prototype.toString,g=Math.max,h=Math.min,m=function(){return u.Date.now()};function y(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function v(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&f.call(e)==r}(e))return i;if(y(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=y(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var n=s.test(e);return n||c.test(e)?l(e.slice(2),n?2:8):a.test(e)?i:+e}e.exports=function(e,t,i){var r,o,a,s,c,l,p=0,d=!1,u=!1,f=!0;if("function"!=typeof e)throw new TypeError(n);function w(t){var n=r,i=o;return r=o=void 0,p=t,s=e.apply(i,n)}function b(e){var n=e-l;return void 0===l||n>=t||n<0||u&&e-p>=a}function x(){var e=m();if(b(e))return j(e);c=setTimeout(x,function(e){var n=t-(e-l);return u?h(n,a-(e-p)):n}(e))}function j(e){return c=void 0,f&&r?w(e):(r=o=void 0,s)}function k(){var e=m(),n=b(e);if(r=arguments,o=this,l=e,n){if(void 0===c)return function(e){return p=e,c=setTimeout(x,t),d?w(e):s}(l);if(u)return c=setTimeout(x,t),w(l)}return void 0===c&&(c=setTimeout(x,t)),s}return t=v(t)||0,y(i)&&(d=!!i.leading,a=(u="maxWait"in i)?g(v(i.maxWait)||0,t):a,f="trailing"in i?!!i.trailing:f),k.cancel=function(){void 0!==c&&clearTimeout(c),p=0,r=l=o=c=void 0},k.flush=function(){return void 0===c?s:j(m())},k}}).call(this,n(0))}});